$(function(){
	$("body").data("spm","7628502"),helper.init()});
	var helper={allTypes:null,init:function(){
		var a=helper,b=$("#xuqiuTypesDiv").text();
		a.allTypes=JSON.parse(b),
		a.renderXuqiuType("",$("#typePid")),$("#typePid").change(function(){
			a.renderXuqiuType(
				$(this).val(),$("#typeId"))}),
	     		$("#publish").click(function(b){
	     			a.showMobileVerifyFunc(b)}),
	     			$("#agree").click(function(){
	     				$(this).is(":checked")?a.enablePublishFunc():a.disablePublishFunc()}),$(".pop-alpha").css({height:$(document).height(),position:"absolute"}),$(".J_btnClose").click(function(b){a.closePopupFunc(b)}),$(".J_btnNo").click(function(b){a.closePopupFunc(b)}),$("#getVcodeLink").click(a.sendMobileVcodeFunc),$(".J_btnYes").click(a.tryPublishXuqiuFunc)},getXuqiuTypeByPid:function(a){var b=helper,c=[];return $.each(b.allTypes,function(b,d){null===a||""===a?void 0===d.pid&&c.push(d):d.pid===parseInt(a)&&c.push(d)}),c},renderXuqiuType:function(a,b){var c=helper,d=c.getXuqiuTypeByPid(a);b.empty(),b.append('<option value="">请选择</option>'),$.each(d,function(a,c){b.append('<option value="'+c.id+'">'+c.name+"</option>")})},disablePublishFunc:function(){$("#publish").addClass("btn-disabled"),$("#publish").unbind("click")},enablePublishFunc:function(){var a=helper;$("#publish").removeClass("btn-disabled"),$("#publish").click(function(b){a.showMobileVerifyFunc(b)})},showMobileVerifyFunc:function(a){var b=helper,c=b.paramVerificationFunc();c&&(a.preventDefault(),$(".pop-alpha").show(),$(".w-pop").show())},tryPublishXuqiuFunc:function(){var a={vcode:$.trim($("#vcode").val()),mobile:$.trim($("#mobile").val()),typeId:$("#typeId").val(),priceRangeId:$("#priceRangeId").val(),title:$.trim($("#title").val()),industry:$.trim($("#industry").val()),reference:$.trim($("#reference").val()),supplierId:$.trim($("#supplierId").val()),csrfToken:$('[name="_csrf_token"]').val()};$.post("/xuqiu/ajax/XuqiuAjax/PublishXuqiu.json",a,function(a){a.finished&&"ok"===a.statusCode?location.href="/task/list.html":alert(a.errorMsg)})},closePopupFunc:function(a){a.preventDefault(),$(".pop-alpha").hide(),$(".w-pop").hide()},paramVerificationFunc:function(){var a="";return""===$("#typeId").val()?a="请选择需求类型":""===$("#priceRangeId").val()?a="请选择心里价位":""===$.trim($("#title").val())?a="请输入一句话描述":$.trim($("#title").val()).length>500?a="需求描述内容过长，请保证不超过500个字符":""===$.trim($("#industry").val())?a="请输入所属行业或领域":$.trim($("#industry").val()).length>200?a="所属行业或领域内容过长，请保证不超过200个字符":$.trim($("#reference").val()).length>500&&(a="参考网址内容过长，请保证不超过500个字符"),""!==a?($(".error-tips").empty().html("<i></i>"+a).show(),!1):($(".error-tips").hide(),!0)},sendMobileVcodeFunc:function(){var a=helper,b=$.trim($("#mobile").val());if(""===b)return alert("手机号码不能为空"),void $("#mobile").select().focus();if(!a.isMobileFormat(b))return alert("请输入正确的手机号码"),void $("#mobile").select().focus();var c={mobile:b};$.post("/xuqiu/ajax/XuqiuAjax/SendPublishXuqiuMobileVerifyCode.json",c,function(b){if($("#getVcodeLink").hide(),$("#countDownSpan").text("获取验证码"),$("#countDownSpan").show(),b.finished&&"ok"===b.statusCode){var c=b.errorMsg;$("#getVcodeLink").unbind("click"),a.countdownResendFunc(c,a.sendMobileVcodeFunc)}else alert(b.errorMsg),$("#getVcodeLink").show(),$("#countDownSpan").hide()})},isMobileFormat:function(a){var b=/^1[0-9]{10}$/.test(a);return b},countdownResendFunc:function(a,b){var c=helper,d=a;0==d?($("#getVcodeLink").show(),$("#countDownSpan").hide(),$("#getVcodeLink").click(b)):($("#countDownSpan").show(),$("#getVcodeLink").hide(),$("#countDownSpan").text(d+"秒后重新发送"),d--,setTimeout(function(){c.countdownResendFunc(d,b)},1e3))}};